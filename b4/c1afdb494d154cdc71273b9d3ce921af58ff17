MEMO: see issue #7; no code in 1.0; rest of the patches are backported
