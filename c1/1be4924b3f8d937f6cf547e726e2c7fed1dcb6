MEMO: related refactoring in b5294aa
